[IMPROVE] An elegant solution to this code should be found
